{% extends "layout.html" %}
{% set cur = "project" %}
{% block body %}

<div id="persons" hidden>{{persons|tojson}}</div>
<div id="orgs" hidden>{{orgs|tojson}}</div>

<div class="content fixed-width">

  <div class="container-fluid">
    <div class="row">

      {% include 'sidebar.html' %}
      
      <div id="main-content" class="col-xs-9">
        <h2 style="float:left;" class="title">Register Your Project</h2>
        <a target="_blank" style="float:right; margin-top: 20px;" href="{{url_for('submit_help')}}" class="btn btn-primary">Help</a>
        <div style="clear:both"></div>
        <span class="required" style="font-family: Georiga,'Times New Roman',Times,serif; color: #002783; float: right"> indicates a required field</span>

        <form method="post" action="/submit/project" method="POST" enctype="multipart/form-data" name="entry" id="entry" onLoad=reset()>
          <div class="form-group">
            <b>Main Award</b>
            <div class="awardTemplate">
              <div id='extraAwardLine' style="height:10px;font-size:10px;display:none;">&nbsp;</div>

                <select name="award" id="award" class="award_select">
                  <option value="" id="award_opt">None</option>
                  <option value="Not_In_This_List">Not In This List</option>
                  {% for grant in nsf_grants %}
                    {% set s = grant['award'] + " " + grant['name'] %}
                    <option value="{{grant['award']}}">{{s}}</option>
                  {% endfor %}
                </select>
                <i>(from NSF FastLane database)</i>


                <a href="#awardsForm" id="removeAwardRow" class="remover"><i class="fa fa-remove"></i></a>
                <input class="input-sm form-control removable user_award_input" type="hidden" size=10 id="user_award" name="user_award" placeholder="Enter Award Number"/> 
              <div style="clear:both"></div>
            </div>
            <div id="more_awards"></div>
            <a href="#awardsForm" id="addAwardRow"><i class="fa fa-plus">&nbsp;</i><span id="add_another_award">Add additional award linked to project</span></a>
          </div>

      
          <div class="form-group required">
            <b>Title:</b><br>
            <textarea required class="form-control" name="title" id="title" rows="2"></textarea>
          </div>

          <div class="form-group">
            <b>Short Title:</b><br>
            <input class="form-control" type="text" name="short_title" id="short_title">
          </div>  
          <div class="form-group required" style="margin:10px 0 10px 0">
            <b>Main Contact:</b><br>
            <div class="input-group">
              <input required class="input-sm form-control" type="text" size=8 id="pi_name_last" name="pi_name_last" value="{{full_name.last_name}}" placeholder="Last Name" /> 
              <span  class="input-group-addon">,</span>
              <input required class="input-sm form-control" type="text" size=8 id="pi_name_first" name="pi_name_first" value="{{full_name.first_name}}" placeholder="First Name" />
            </div>
          </div>


          <div class="input-group form-group">
            <b>Institution:</b><br>
              <input class="input-sm form-control" type="text" id="org" name="org" value="" /> 
          </div>

   
          <div class="form-group required">
            <b>Email:</b><br>
            <input class="form-control" type="text" name="email" id="email" value="{{email}}" required>
          </div>


          <div class="form-group" name="copiForm">
            <label for="author">Additional Personnel:</label> 
            <div class="authorTemplate">
              <div id='extraAuthorLine' style="height:5px;font-size:5px;display:none;">&nbsp;</div>
     
              <table>
                <tr>
                  <td width="10%"><i>Name&nbsp;</i></td>
                  <td>
                    <div class="input-group removable" style="margin-bottom:2px">
                      <input class="input-sm form-control" type="text" size=50 id="copi_name_last" name="copi_name_last" value="" placeholder="Last Name"/> 
                      <span  class="input-group-addon">,</span>
                      <input class="input-sm form-control" type="text" size=50 id="copi_name_first" name="copi_name_first" value="" placeholder="First Name"/>
                    </div>
                    <a href="#authorsForm" id="removeAuthorRow" class="remover"><i class="fa fa-remove"></i></a>
                  </td>
                </tr>
                <tr>
                  <td><i>Institution&nbsp;</i></td>
                  <td>
                    <div class="input-group removable">
                      <input class="input-sm form-control" type="text" size=70 id="copi_org" name="copi_org" value="" placeholder="Institution" style="margin-bottom:2px"/> 
                    </div>
                  </td>
                </tr>
                <tr>
                  <td><i>Role&nbsp;</i></td>
                  <td>
                    <select class="input-sm form-control removable" name="copi_role" id="copi_role" style="margin-bottom:6px">
                      <option value="">(Select Role)</option>
                      {% for r in roles %}
                        <option value="{{r.id}}">{{r.id}}</option>
                      {% endfor %}
                    </select>
                  </td>
                </tr>
              </table>             
              <div style="clear:both"></div>
            </div>
            <div id="more_authors"></div>
            <a href="#authorsForm" id="addAuthorRow"><i class="fa fa-plus">&nbsp;</i><span id="add_another_author">Add another author</span></a>
          </div>

          <table>
            <tr>
              <th class="required">Start Date:</th>
              <th width="40px"></th>
              <th class="required">End Date:</th>
            </tr>
            <tr>
              <td><input required type="date" name="start" id="start" size="20"></td>
              <td></td>
              <td><input required type="date" name="end" id="end" size="20"></td>
            </tr>
          </table>

          <br>
          <b>Special Science Program:</b><br>
          <i>if not in list, please make a note in the comment box</i><br>
          <select name="program" id="program">
            <option value="">(Select Program)</option>
            {% for p in programs %}
              <option value="{{p}}">{{p.id}}</option>
            {% endfor %}
          </select><br><br>

          <div class="form-group" name="websiteForm">
            <label for="website">Project Website:</label>
            <div class="websiteTemplate">
              <div id='extraWebsiteLine' style="height:10px;font-size:10px;display:none;">&nbsp;</div>
              <table>
                <tr>
                  <td width="10%"><i>Title&nbsp;</i></td>
                  <td><input class="removable" type="text" name="website_title" id="website_title" size="90" style="margin-bottom:2px">
                      <a href="#websiteForm" id="removeWebsiteRow" class="remover"><i class="fa fa-remove"></i></a></td>
                </tr>
                <tr>
                  <td><i>URL&nbsp;</i></td>
                  <td><input class="removable" type="text" name="website_url" id="website_url" size="90"></td>
                </tr>
              </table>
              <div style="clear:both"></div>
            </div>
            <div id="more_websites"></div>
            <a href="#websitesForm" id="addWebsiteRow"><i class="fa fa-plus">&nbsp;</i><span id="add_another_website">Add another website</span></a>
          </div>
        
          <div id="deployments" class="form-group" name="deploymentForm">
            <b>Deployment:</b><br>
            <i>add only if project has field work</i><br>
            <div class="deploymentTemplate">
              <div id='extraDeploymentLine' style="height:10px;font-size:10px;display:none;">&nbsp;</div>
              <table>
                <tr>
                  <td width="10%"><i>Name&nbsp;</i></td>
                  <td><input class="removable" type="text" name="deployment_name" id="deployment_name" size="90" style="margin-bottom:2px">
                      <a href="#deploymentForm" id="removeDeploymentRow" class="remover"><i class="fa fa-remove"></i></a></td>
                </tr>
                <tr>
                  <td><i>Type&nbsp;</i></td>
                  <td>          
                    <select name="deployment_type" id="deployment_type">
                      <option value="">(Select Type)</option>
                      {% for t in deployment_types %}
                        <option value="{{t.deployment_type}}">{{t.deployment_type}}</option>
                      {% endfor %}
                    </select>
                  </td>
                </tr>
                <tr>
                  <td><i>URL&nbsp;</i></td>
                  <td><input class="removable" type="text" name="deployment_url" id="deployment_url" size="90"></td>
                </tr>
              </table>
              <div style="clear:both"></div>
            </div>
            <div id="more_deployments"></div>
            <a href="#deploymentsForm" id="addDeploymentRow"><i class="fa fa-plus">&nbsp;</i><span id="add_another_deployment">Add another deployment</span></a>
          </div>

          <div>
            <b>Upload Data Management Plan</b>
            <br>
            <input type="file" name="dmp" style="font-size: 1em;">
          </div>
          <br>

          <b class="required">Abstract:</b> <br>
          <i>(Please modify the original NSF award abstract to better describe the project results, if applicable)</i><br>
          <textarea required name="sum" id="sum" rows="10" cols="80"></textarea>

          <br><br>
          <div class="form-group required">
            <b>Location(s):</b> &nbsp;<i>(terms from the <a class="external" href="http://gcmd.gsfc.nasa.gov/Resources/valids/archives/keyword_list.html">GCMD</a> Keyword list)</i><br>
            <div id="locations">
              <select required name="location1" id="location1" style="width:40em;margin-bottom: 3px">
                <option value="">(Select Term 1)</option>
                {% for k in locations %}
                <option value="{{k.id}}">{{k.id}}</option>
                {% endfor %}
              </select>
            </div>
            <button type="button" id="add-location">Add Term</button>
          </div>

          <div class="form-group">
            <b>Location(s) - not GCMD:</b> &nbsp;<i>(Free text, separated by commas)</i>
            <textarea class="form-control" name="location_free" id="location_free" rows="1"></textarea>
          </div>

        <div class="form-group required">
          <b>GCMD Keyword(s):</b> &nbsp;<i>(terms from the <a class="external" href="http://gcmd.gsfc.nasa.gov/Resources/valids/archives/keyword_list.html">GCMD</a> Keyword list)</i><br>
          <div id="parameters">
            <select required name="parameter1" id="parameter1" style="width:40em;margin-bottom: 3px">
              <option value="">(Select Term 1)</option>
              {% for k in parameters %}
                <option value="{{k.id}}">{{k.id}}</option>
              {% endfor %}
            </select>
          </div>
          <button type="button" id="add-parameter">Add Term</button>
        </div>
        <br>

        <div>
          <b>Spatial Bounds of Data</b> <br/>Use decimal degrees. Longitudes must be in -180 to 180 range. Example:<br /> Ross Sea is between 160 and -150
          <table style="border:0">
            <tbody>
              <tr>
                <td align="center">
                  &nbsp;N: <input type="text" name="geo_n" class="coord-element" id="geo_n" size="5" value=""> <br>
                  W: <input type="text" name="geo_w" class="coord-element" id="geo_w" size="6" value=""> &nbsp; &nbsp; &nbsp;&nbsp; E: <input type="text" name="geo_e" class="coord-element" id="geo_e" size="6" value=""> <br>
                  S: <input type="text" name="geo_s" class="coord-element" id="geo_s" size="5" value="">
                </td>
                <td>
                  <span style="margin: 20px">
                    <input type="checkbox" name="entire_region" class="coord-element"> Entire Antarctic Region</input><br/>
                  </span>
                  <span style="margin: 20px">
                   <input type="checkbox" name="cross_dateline" class="coord-element" id="cross_dateline"> Check if your bounds cross the International Date Line</input>
                  </span>
                   <br><button id="show_on_map_btn" type ="button" class="btn btn-default btn-sm map-btn">Show on Map</button>
                 </td>
               </tr>
             </tbody>
           </table>
           

          <div id="geometry">
            <div id="geometry_header" class="window-header">
              <span id="geometry_title"></span><span class='close_geom_btn close_btn'>X</span>
            </div>
            <div id="map">
              <button id="confirm_btn" type="button" class="btn btn-primary btn-sm confirm-btn close_geom_btn">Confirm Coordinates</button>
            </div>
          </div>
        </div>

        <br>
        <div class="form-group" name="publicationsForm">
          <label for="publication">Project Publications</label>
          <span><i>Include DOI where known</i></span>
          <div class="publicationTemplate">
            <div id='extraPubLine' style="height:10px;font-size:10px;display:none;">&nbsp;</div>
            <textarea id="publication" name="publication" class="form-control removable" style="margin-bottom:2px"></textarea>
            <a href="#publicationsForm" id="removePubRow" class="remover"><i class="fa fa-remove"></i></a>
            <input class="input-sm form-control removable" type="text" size=10 id="pub_doi" name="pub_doi" value="" placeholder="DOI"/> 
            <div style="clear:both"></div>
          </div>
          <div id="more_publications"></div>
          <a href="#publicationsForm" id="addPubRow"><i class="fa fa-plus">&nbsp;</i><span id="add_another_pub">Add another publication</span></a>
        </div>

        <div id="datasets" class="form-group" name="datasetsForm">
          <label>Datasets</label>
          <span><i>Include DOI where known</i></span>
          <div class="datasetTemplate">
            <div id='extraDatasetLine' style="height:10px;font-size:10px;display:none;">&nbsp;</div>
            <table>
              <tr>
                <td width="20%"><a target="_blank" href="{{url_for('repo_list')}}"><i>Repository</i></a></td>
                <td><input class="input-sm form-control removable" type="text" id="ds_repo" name="ds_repo"  style="margin-bottom:2px"/>
                  <a href="#datasetForm" id="removeDatasetRow" class="remover"><i class="fa fa-remove"></i></a></td>
              </tr>

              <tr>
                <td><i>Title</i></td>
                <td><textarea class="input-sm form-control removable" name="ds_title" id="ds_title" rows="1" cols="74" style="margin-bottom:2px"></textarea></td>
              </tr>
              <tr>
                <td><i>URL</i></td>
                <td><textarea class="input-sm form-control removable" name="ds_url" id="ds_url" rows="1" cols="74" style="margin-bottom:2px"></textarea></td>
              </tr>
              <tr>
                <td><i>DOI</i></td>
                <td><input class="input-sm form-control removable" type="text" id="ds_doi" name="ds_doi" style="margin-bottom:2px"/></td>
              </tr>
            </table>
            <div style="clear:both"></div>
          </div>
          <div id="more_datasets"></div>
          <a href="#datasetsForm" id="addDatasetRow"><i class="fa fa-plus">&nbsp;</i><span id="add_another_dataset">Add another dataset</span></a>
        </div>
       <!--  <input type="checkbox" name="nodata"> This is an interim report - my data aren't ready yet.
        <br><br> -->

        <b>Other comments relevant for data submission:</b><br>
        <textarea name="other_comments" rows="3" cols="80"></textarea><br>
        <br>

        <button value="Submit" name="entry">Submit</button>
      </form>

    </div>
  </div>
</div>
</div>

{% endblock body %}